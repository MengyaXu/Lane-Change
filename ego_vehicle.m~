function zp = ego_vehicle(z, u)
%% Kinematic Bicycle Model 

lr = 1; lf = 1;
dt = 0.2; % sampling time

% State and Input
% z = (x, y, v, phi), u = [acc, beta]
nz = 4; nu = 2; 
z0 = [(x2+x3)/2;0;1;0];
fdyn = @(z,u) [z(3)*cos(z(4)+u(2)); z(3)*sin(z(4)+u(2)); u(1); z(3)/lr*sin(u(2))];
znext = @(z,u) z + fdyn(z,u)*dt; %Discrete time

zp = znext
    zp(1) = z(1)+TS*z(3)*cos(z(4)+u(2));
    zp(2) = z(2)+TS*z(3)*sin(z(4)+u(2));
    zp(3) = z(3)+TS*u(1);
    zp(4) = z(4)+TS*z(3)*sin(u(2))/lr;
    
%     xp = x + TS*v*cos(psi+beta);
%     yp = y + TS*v*sin(psi+beta);
%     vp = v + TS*a;
%     psip = psi + TS*v*sin(beta)/lr;
end